# –û–±–∑–æ—Ä Docker Testing Pipeline –¥–ª—è Sysaudit

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø–∞–π–ø–ª–∞–π–Ω–∞)
2. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
3. [–¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤](#—Ç–∏–ø—ã-—Ç–µ—Å—Ç–æ–≤)
4. [–û—Ç—á–µ—Ç—ã](#–æ—Ç—á–µ—Ç—ã)
5. [CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#cicd-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
6. [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Docker Build Stage                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ  ‚îÇ   Builder    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Runtime    ‚îÇ                  ‚îÇ
‚îÇ  ‚îÇ  (deps)      ‚îÇ         ‚îÇ  (minimal)   ‚îÇ                  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      Test Execution                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ   Unit   ‚îÇ  ‚îÇIntegration‚îÇ  ‚îÇCompliance‚îÇ  ‚îÇ   E2E    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Tests   ‚îÇ  ‚îÇ  Tests    ‚îÇ  ‚îÇ  Tests   ‚îÇ  ‚îÇ  Tests   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Report Generation                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ  ‚îÇ Coverage ‚îÇ  ‚îÇ   JSON   ‚îÇ  ‚îÇ Markdown ‚îÇ                  ‚îÇ
‚îÇ  ‚îÇ   HTML   ‚îÇ  ‚îÇ  Reports ‚îÇ  ‚îÇ  Summary ‚îÇ                  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üß© –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. Dockerfile

**–ú–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è —Å–±–æ—Ä–∫–∞:**

```dockerfile
# Stage 1: Builder
FROM python:3.11-slim as builder
# - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ build –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
# - –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
# - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –ø–∞–∫–µ—Ç–æ–≤

# Stage 2: Runtime
FROM python:3.11-slim
# - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑
# - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ
# - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞: ~200MB (–≤–º–µ—Å—Ç–æ ~500MB)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –Ω–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–≤ –≤ runtime
- –°–∫–æ—Ä–æ—Å—Ç—å: –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤

### 2. docker-compose.yml

**–°–µ—Ä–≤–∏—Å—ã:**

```yaml
sysaudit-test:        # Unit, Integration, Compliance —Ç–µ—Å—Ç—ã
sysaudit-e2e:         # E2E —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏
sysaudit-report:      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Ç–æ–≥–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
```

**–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è:**
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ volumes –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 3. –°–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞

**Linux/macOS:** `scripts/run-docker-tests.sh`
- Bash —Å–∫—Ä–∏–ø—Ç —Å —Ü–≤–µ—Ç–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ç–µ—Å—Ç–æ–≤
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞

**Windows:** `scripts/run-docker-tests.ps1`
- PowerShell —Å–∫—Ä–∏–ø—Ç
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ Windows –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### 4. GitHub Actions Workflow

**–§–∞–π–ª:** `.github/workflows/docker-ci.yml`

**Jobs:**
1. **build** - —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
2. **test-unit** - unit —Ç–µ—Å—Ç—ã
3. **test-integration** - integration —Ç–µ—Å—Ç—ã
4. **test-compliance** - compliance —Ç–µ—Å—Ç—ã
5. **test-e2e** - E2E —Ç–µ—Å—Ç—ã
6. **report** - –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
7. **publish** - –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞ (main only)

## üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. Unit Tests

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- `FilterManager` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
- `FileMonitor` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤
- `GitManager` - Git –æ–ø–µ—Ä–∞—Ü–∏–∏ (commit, diff, log)
- `ComplianceChecker` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `AlertManager` - —Å–∏—Å—Ç–µ–º–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
- `DriftDetector` - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞
- `RollbackManager` - –æ—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ó–∞–ø—É—Å–∫:**
```bash
docker run --rm sysaudit:test python run_tests.py --unit --coverage
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞: >80%
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤: ~40
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~10s

### 2. Integration Tests

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è FileMonitor + GitManager
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –∏ –±–∞—Ç—á–∏–Ω–≥
- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
- –¶–µ–ø–æ—á–∫–∞: —Å–æ–±—ã—Ç–∏–µ ‚Üí —Ñ–∏–ª—å—Ç—Ä ‚Üí Git ‚Üí compliance

**–ó–∞–ø—É—Å–∫:**
```bash
docker run --rm sysaudit:test python run_tests.py --integration
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤: ~15
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~15s

### 3. Compliance Tests

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ world-writable —Ñ–∞–π–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ SUID/SGID –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
- –°–ª–∞–±—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ (text, JSON, HTML)

**–ó–∞–ø—É—Å–∫:**
```bash
docker run --rm sysaudit:test python run_tests.py --compliance
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤: ~10
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~8s

### 4. E2E Tests (Real User Scenarios)

**–°—Ü–µ–Ω–∞—Ä–∏–∏:**

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
```python
# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
sysaudit init --repo /var/lib/sysaudit/repo
sysaudit --version
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤
```python
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, —Ñ–∏–∫—Å–∞—Ü–∏—è
sysaudit snapshot -m "Initial"
# ... –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ ...
sysaudit snapshot -m "Updated"
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
git log
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞
```python
# –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–∏
sysaudit snapshot -m "Baseline"
# ... –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ ...
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–∏—Ñ—Ç–∞
sysaudit drift-check --baseline main
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
```python
# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
chmod 666 unsafe.conf
# –ü—Ä–æ–≤–µ—Ä–∫–∞
sysaudit compliance-report
sysaudit compliance-report --format json
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
```python
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–π
sysaudit snapshot -m "Version 1"
# ... –∏–∑–º–µ–Ω–µ–Ω–∏–µ ...
sysaudit snapshot -m "Version 2"
# –û—Ç–∫–∞—Ç
sysaudit rollback --to-commit <hash> --dry-run
sysaudit rollback --to-commit <hash>
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 6: CLI –∫–æ–º–∞–Ω–¥—ã
```python
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö CLI –∫–æ–º–∞–Ω–¥
sysaudit --help
sysaudit init --help
sysaudit monitor --help
# ... –∏ —Ç.–¥.
```

**–ó–∞–ø—É—Å–∫:**
```bash
docker run --rm --user root sysaudit:test \
  python tests/e2e/test_real_user_scenarios.py
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤: 6
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: ~20
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~30s

## üìä –û—Ç—á–µ—Ç—ã

### 1. Coverage Report (HTML)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `htmlcov/index.html`

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- –û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ –º–æ–¥—É–ª—è–º
- –ù–µ–ø–æ–∫—Ä—ã—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è

**–ü—Ä–æ—Å–º–æ—Ç—Ä:**
```bash
open htmlcov/index.html  # macOS
xdg-open htmlcov/index.html  # Linux
start htmlcov\index.html  # Windows
```

### 2. E2E Report (JSON)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `test-results/e2e-report.json`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```json
{
  "timestamp": "2024-01-15T10:30:00",
  "test_type": "e2e",
  "passed": 20,
  "failed": 0,
  "total": 20,
  "duration_seconds": 30.5,
  "success_rate": "100.0%"
}
```

### 3. Final Report (JSON)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `test-results/final-report.json`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```json
{
  "timestamp": "2024-01-15T10:30:00",
  "project": "sysaudit",
  "version": "0.1.0",
  "commit": "abc123",
  "branch": "main",
  "tests": {
    "unit": { "passed": 40, "failed": 0 },
    "integration": { "passed": 15, "failed": 0 },
    "compliance": { "passed": 10, "failed": 0 },
    "e2e": { "passed": 20, "failed": 0 }
  },
  "summary": {
    "total_tests": 85,
    "passed": 85,
    "failed": 0,
    "success_rate": "100.0%"
  }
}
```

### 4. Markdown Summary (GitHub Actions)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è PR:**

```markdown
# Test Report

**Project:** sysaudit
**Version:** 0.1.0
**Commit:** abc123
**Branch:** feature/new-feature

## Summary

- **Total Tests:** 85
- **Passed:** 85 ‚úì
- **Failed:** 0 ‚úó
- **Success Rate:** 100.0%

## Test Results by Type

### UNIT
- Passed: 40
- Failed: 0
- Duration: 10.2s

### INTEGRATION
- Passed: 15
- Failed: 0
- Duration: 15.3s

### COMPLIANCE
- Passed: 10
- Failed: 0
- Duration: 8.1s

### E2E
- Passed: 20
- Failed: 0
- Duration: 30.5s
```

## üîÑ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### GitHub Actions

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- Push –≤ `main` –∏–ª–∏ `develop`
- Pull Request
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

**Workflow:**
```
Push/PR ‚Üí Build ‚Üí Tests (parallel) ‚Üí Report ‚Üí Publish (main only)
```

**–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:**
- Docker –æ–±—Ä–∞–∑ (1 –¥–µ–Ω—å)
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ (90 –¥–Ω–µ–π)
- Coverage –æ—Ç—á–µ—Ç (90 –¥–Ω–µ–π)
- –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç (90 –¥–Ω–µ–π)

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ PR —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- Email –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- Status badge –≤ README

### –î—Ä—É–≥–∏–µ CI —Å–∏—Å—Ç–µ–º—ã

**Jenkins:**
```groovy
pipeline {
    agent any
    stages {
        stage('Test') {
            steps {
                sh './scripts/run-docker-tests.sh'
            }
        }
    }
    post {
        always {
            publishHTML([
                reportDir: 'htmlcov',
                reportFiles: 'index.html',
                reportName: 'Coverage Report'
            ])
        }
    }
}
```

**GitLab CI:**
```yaml
test:
  image: docker:latest
  services:
    - docker:dind
  script:
    - ./scripts/run-docker-tests.sh
  artifacts:
    paths:
      - test-results/
      - htmlcov/
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
docker build -t sysaudit:test .
docker run --rm sysaudit:test python run_tests.py --fast

# –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä
./scripts/run-docker-tests.sh

# –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∏–ø—ã
make -f Makefile.docker test-unit
make -f Makefile.docker test-e2e
```

### Pre-commit hook

```bash
# .git/hooks/pre-commit
#!/bin/bash
docker build -q -t sysaudit:test . && \
docker run --rm sysaudit:test python run_tests.py --fast
```

### Continuous Testing

```bash
# Watch mode (—Ç—Ä–µ–±—É–µ—Ç entr –∏–ª–∏ similar)
ls sysaudit/**/*.py | entr -c ./scripts/run-docker-tests.sh
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∏ KPI

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- **–¶–µ–ª—å:** >80%
- **–¢–µ–∫—É—â–µ–µ:** ~85%
- **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –º–æ–¥—É–ª–∏:** >90%

### –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **Unit:** ~10s
- **Integration:** ~15s
- **Compliance:** ~8s
- **E2E:** ~30s
- **–í—Å–µ–≥–æ:** ~65s

### –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- **Flaky tests:** 0
- **Success rate:** 100%
- **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å:** –î–∞

### –†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞
- **Builder:** ~500MB
- **Runtime:** ~200MB
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** 60%

## üéØ Best Practices

### 1. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ pre-commit hooks
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CI/CD –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### 2. –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
- –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ fixtures –¥–ª—è setup/teardown
- –ù–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 3. –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –ø–µ—Ä–≤—ã–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--fast` –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑—É–π—Ç–µ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

### 4. –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –≤—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ coverage –æ—Ç—á–µ—Ç—ã
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç—Ä–µ–Ω–¥—ã

### 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ –æ–±—Ä–∞–∑—ã –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ —Ä–µ—Å—É—Ä—Å—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

1. **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤**
   - –¢—Ä–µ–Ω–¥ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
   - –ú–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

2. **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**
   - –û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
   - –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ –º–æ–¥—É–ª—è–º
   - –ù–µ–ø–æ–∫—Ä—ã—Ç—ã–µ —É—á–∞—Å—Ç–∫–∏

3. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**
   - Success rate
   - Flaky tests
   - –ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–æ–≤–∞–ª–æ–≤

4. **–†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞**
   - –¢—Ä–µ–Ω–¥ —Ä–æ—Å—Ç–∞
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ª–æ–µ–≤
   - –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[QUICK_START_DOCKER.md](QUICK_START_DOCKER.md)** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- **[README_DOCKER.md](README_DOCKER.md)** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **[DOCKER_EXAMPLES.md](DOCKER_EXAMPLES.md)** - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **[.github/workflows/README.md](.github/workflows/README.md)** - CI/CD –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **[TESTING.md](TESTING.md)** - –û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤:

1. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –ª–æ–∫–∞–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ coverage
4. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å `--verbose`
