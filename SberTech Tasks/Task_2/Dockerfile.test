FROM rust:1.83-slim

RUN apt-get update && apt-get install -y liburing-dev build-essential && rm -rf /var/lib/apt/lists/*

WORKDIR /app
COPY . .

# Run tests with proper output
CMD ["cargo", "test", "--lib", "wal::tests", "--no-fail-fast", "--", "--test-threads=1", "--nocapture"]
